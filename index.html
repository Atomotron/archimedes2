<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Archimedes Engine 2</title>
    <script type="module" src="index.js"></script>
</head>
<body>

<canvas id='canvas' width=256 height=256></canvas>

<script id="shader-v" type="x-shader/x-vertex">
#version 100
#extension GL_OES_standard_derivatives : enable
attribute vec2 vertex;
varying vec2 world_coord;
varying float daytime;
uniform mat3 inverse_view;
uniform float varray[3];
uniform vec2 solar_vector;
void main() {
    gl_Position = vec4(vertex,0.0,1.0); 
    world_coord = (inverse_view * vec3(vertex,1.0)).xy;
    daytime = dot(world_coord,solar_vector);
}
</script>

<script id="shader-f" type="x-shader/x-fragment">
#version 100
#extension GL_OES_standard_derivatives : enable
precision highp float;
varying vec2 world_coord;
varying float daytime;
uniform float planet_radius;
uniform sampler2D gradient;
void main() {
    float r = length(world_coord)/planet_radius;
    float darkness = 1.0/(r*r);
    float texture_index = r + 0.25*smoothstep(0.5-0.0005,0.5+0.0005,0.5*r)-0.125;
    gl_FragColor = darkness*texture2D(gradient,vec2(texture_index,daytime+0.5));
}
</script>

<script>


</script>

</body>
</html>
