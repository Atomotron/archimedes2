<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>AEâ…¡ Shader Demo</title>
    <link rel="shortcut icon" href="../favicon.png" type="image/x-icon">
    <script type="module" src="./test.js"></script>
    
    <style>
      html, body {
        height: 100%;
        margin: 0;
      }
      /* make the canvas fill its container */
      #canvas {
        width: 100%;
        height: 100%;
        display: block;
      }
    </style>
</head>
<body>

<script id="shader-v" type="x-shader/x-vertex">
#version 100
#extension GL_OES_standard_derivatives : enable
precision highp float;
attribute vec2 vertex;
uniform float time;
void main() {
    gl_Position = vec4(vertex,0.0,1.0); 
}
</script>

<script id="shader-f" type="x-shader/x-fragment">
#version 100
#extension GL_OES_standard_derivatives : enable
precision highp float;
uniform float time;
uniform vec2 centers[3];
uniform sampler2D background;
void main() {
    vec2 p = gl_FragCoord.xy-vec2(256,256);
    float zoom = ( sin(time*0.25)*0.5 )*0.05;
    vec3 color = vec3(0.0,0.0,0.0);
    vec2 distortion = vec2(0.0,0.0);
    for (int i=0; i<3; i++) {
        vec2 x = p-centers[i];
        float r = length(x)*zoom;
        float f = (sin((r-time*2.0 + atan(x.y,x.x))*3.0) / (r*r))*30.5+0.5;
        color += vec3(1.0 * f,0.2 * f,0.13);
        distortion += vec2(0.1*f,0.1*f);
    }
    color *= texture2D(background, gl_FragCoord.xy * (1.0/512.0) + distortion).xyz;
    gl_FragColor = vec4(color,1.0);
}
</script>
<canvas id='canvas' width=512 height=512></canvas>
<img id='tex' src="./tools-861x599-martin-vorel.jpg" alt="texture image" style="display:none;"></img>


</body>
</html>
